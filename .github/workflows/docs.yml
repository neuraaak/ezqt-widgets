name: Deploy Documentation

on:
  push:
    branches: [main]
    paths:
      - "docs/**"
      - "mkdocs.yml"
      - "ezqt_widgets/**"
  workflow_dispatch:

permissions:
  contents: write

env:
  PACKAGE_NAME: ezqt-widgets
  PYTHON_VERSION: "3.11"
  # DÃ©pendances systÃ¨me supplÃ©mentaires nÃ©cessaires avant l'installation du package
  # Laisser vide si aucune dÃ©pendance systÃ¨me n'est requise
  EXTRA_SYSTEM_DEPS: ""

jobs:
  deploy:
    name: Build and Deploy Docs
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: ${{ env.PYTHON_VERSION }}
          cache: "pip"

      - name: Install extra system dependencies
        if: env.EXTRA_SYSTEM_DEPS != ''
        run: |
          echo "ðŸ“¦ Installing extra system dependencies..."
          pip install ${{ env.EXTRA_SYSTEM_DEPS }} --no-cache-dir

      - name: Install package with docs dependencies
        run: |
          echo "ðŸ“¦ Installing package and docs dependencies..."
          python -m pip install --upgrade pip
          pip install -e ".[docs]"

      - name: Build and deploy documentation
        run: |
          echo "ðŸ“š Building and deploying documentation for ${{ env.PACKAGE_NAME }}..."
          mkdocs gh-deploy --force
          echo "âœ… Documentation deployed successfully!"
